<!DOCTYPE html>
<html>
<head>
    <title>SaaS Systems Quote Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.6.1/firebase-app-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <link href="css/plarforms.css" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assests/_DSC00521.JPG" />
</head>
<body>
    <h1>SaaS Systems Quote Calculator</h1>
    
    <form id="quoteForm">
        <div class="system-section">
            <h2>Select System Type</h2>
            <select id="systemType" onchange="toggleSystemOptions()">
                <option value="">Select a System</option>
                <option value="healthcare">Digital Healthcare Management Suite</option>
                <option value="event">Enterprise Event Management Solution</option>
                <option value="supply">Intelligent Supply Chain Management System</option>
            </select>
        </div>

        <!-- Healthcare System Options -->
        <div id="healthcareOptions" class="system-section hidden">
            <h3>Healthcare Management Suite</h3>
            <select id="healthcarePlan">
                <option value="base">Base Plan (Must-Haves)</option>
                <option value="standard">Standard Plan (Should-Haves)</option>
                <option value="premium">Premium Plan (Nice-to-Haves)</option>
                <option value="enterprise">Enterprise Plan (Custom)</option>
            </select>
            
            <select id="healthcareSize">
                <option value="private">Private Doctor/Clinic</option>
                <option value="small">Small Hospital/Clinic</option>
                <option value="medium">Medium Hospital/Clinic</option>
                <option value="large">Large Hospital/Clinic</option>
            </select>
        </div>

        <!-- Event Management Options -->
        <div id="eventOptions" class="system-section hidden">
            <h3>Event Management Solution</h3>
            <select id="eventAttendees">
                <option value="tier1">1-100 Attendees</option>
                <option value="tier2">20-250 Attendees</option>
                <option value="tier3">50-400 Attendees</option>
                <option value="tier4">100-1000 Attendees</option>
                <option value="tier5">1000+ Attendees</option>
            </select>
            
            <select id="eventDuration">
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
                <option value="quarterly">Quarterly</option>
                <option value="annually">Annually</option>
            </select>

            <div id="extraAttendeesDiv" class="hidden">
                <label>Additional Attendees (beyond 1000):</label>
                <input type="number" id="extraAttendees" min="0" step="150">
            </div>
        </div>

        <!-- Supply Chain Options -->
        <div id="supplyOptions" class="system-section hidden">
            <h3>Supply Chain Management System</h3>
            
            <div class="component-group">
                <h4>Transportation Management System (TMS)</h4>
                <input type="checkbox" id="tmsCheck" onchange="toggleCapacity('tms')">
                <select id="tmsCapacity" disabled>
                    <option value="small">Small capacity (R15,000/month)</option>
                    <option value="medium">Medium capacity (R25,000/month)</option>
                    <option value="large">Large capacity (R45,000/month)</option>
                </select>
            </div>

            <div class="component-group">
                <h4>Warehouse Management System (WMS)</h4>
                <input type="checkbox" id="wmsCheck" onchange="toggleCapacity('wms')">
                <select id="wmsCapacity" disabled>
                    <option value="small">Small warehouse (R18,000/month)</option>
                    <option value="medium">Medium warehouse (R30,000/month)</option>
                    <option value="large">Large warehouse (R55,000/month)</option>
                </select>
            </div>

            <div class="component-group">
                <h4>Order Fulfillment Module</h4>
                <input type="checkbox" id="ofmCheck" onchange="toggleCapacity('ofm')">
                <select id="ofmCapacity" disabled>
                    <option value="basic">Basic (R8,000/month)</option>
                    <option value="standard">Standard (R15,000/month)</option>
                    <option value="enterprise">Enterprise (R25,000/month)</option>
                </select>
            </div>

            <div class="component-group">
                <h4>Customer Portal</h4>
                <input type="checkbox" id="portalCheck" onchange="toggleCapacity('portal')">
                <select id="portalCapacity" disabled>
                    <option value="basic">Basic (R5,000/month)</option>
                    <option value="professional">Professional (R12,000/month)</option>
                    <option value="enterprise">Enterprise (R20,000/month)</option>
                </select>
            </div>

            <div class="component-group">
                <h4>Admin Dashboard</h4>
                <input type="checkbox" id="adminCheck" onchange="toggleCapacity('admin')">
                <select id="adminCapacity" disabled>
                    <option value="basic">Basic (R4,000/month)</option>
                    <option value="professional">Professional (R8,000/month)</option>
                    <option value="enterprise">Enterprise (R15,000/month)</option>
                </select>
            </div>

            <div class="component-group">
                <h4>Additional Options</h4>
                <label>Number of Additional Users:</label>
                <input type="number" id="additionalUsers" min="0" value="0"><br>
                <label>Premium Support:</label>
                <input type="checkbox" id="premiumSupport">
            </div>
        </div>

        <div class="contact-section">
            <h3>Your Contact Information</h3>
            <label for="customerName">Name:</label>
            <input type="text" id="customerName" oninput="updateContactInfo()" required>
            
            <label for="customerEmail">Email:</label>
            <input type="email" id="customerEmail" oninput="updateContactInfo()" required>
            
            <label for="customerPhone">Phone:</label>
            <input type="tel" id="customerPhone" oninput="updateContactInfo()">
            
            <label for="customerNotes">Notes:</label>
            <textarea id="customerNotes" oninput="updateContactInfo()"></textarea>
        </div>


        <div class="total-section">
            <h3>Detailed Quote Summary</h3>
            <p><strong>Selected System:</strong> <span id="selectedSystem">N/A</span></p>
            <p><strong>Plan/Components:</strong> <span id="selectedPlan">N/A</span></p>
            <p><strong>Breakdown of Costs:</strong></p>
            <ul id="costBreakdown"></ul>
            <p><strong>Monthly Cost:</strong> R<span id="monthlyTotal">0</span></p>
            <p><strong>Annual Cost:</strong> R<span id="annualTotal">0</span></p>
        </div>

       

        <div class="contact-display">
            <p><strong>Name:</strong> <span id="displayCustomerName">N/A</span></p>
            <p><strong>Email:</strong> <span id="displayCustomerEmail">N/A</span></p>
            <p><strong>Phone:</strong> <span id="displayCustomerPhone">N/A</span></p>
            <p><strong>Notes:</strong> <span id="displayCustomerNotes">N/A</span></p>
        </div>

        <button type="button" onclick="saveQuote()">Save Quote</button>
        <p id="confirmationMessage" style="display: none; color: green; font-weight: bold;"></p>
    </form>

    <script>
       

        const firebaseConfig = {
            apiKey: "AIzaSyA-dWJYv1m5EoHT2AkcOUzrerIWy4biGd4",
            authDomain: "jabulanigwalaportfolio.firebaseapp.com",
            projectId: "jabulanigwalaportfolio",
            storageBucket: "jabulanigwalaportfolio.firebasestorage.app",
            messagingSenderId: "961267386634",
            appId: "1:961267386634:web:0d466c481eb2d36ee892f3"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();


        function toggleSystemOptions() {
            const systemType = document.getElementById('systemType').value;
            
            // Hide all system options first
            document.getElementById('healthcareOptions').classList.add('hidden');
            document.getElementById('eventOptions').classList.add('hidden');
            document.getElementById('supplyOptions').classList.add('hidden');
            
            // Show selected system options
            if (systemType) {
                document.getElementById(systemType + 'Options').classList.remove('hidden');
            }
            
            calculateTotal();
        }

        function validateForm() {
    const name = document.getElementById('customerName').value.trim();
    const email = document.getElementById('customerEmail').value.trim();
    
    if (name === "" || email === "") {
        alert("Please enter your name and a valid email address before saving.");
        return false;
    }
    
    return true;
}

function generateQuoteSerial() {
    return "Q-" + Math.floor(Math.random() * 1000000);
}
function saveQuote() {
        if (!validateForm()) return;

        const quote = {
            systemType: document.getElementById('systemType').value,
            customerName: document.getElementById('customerName').value,
            customerEmail: document.getElementById('customerEmail').value,
            customerPhone: document.getElementById('customerPhone').value,
            customerNotes: document.getElementById('customerNotes').value,
            monthlyTotal: parseFloat(document.getElementById('monthlyTotal').textContent.replace(/,/g, '')),
            annualTotal: parseFloat(document.getElementById('annualTotal').textContent.replace(/,/g, '')),
            system: document.getElementById('selectedSystem').textContent,
            plan: document.getElementById('selectedPlan').textContent,
            breakdown: Array.from(document.getElementById('costBreakdown').children).map(li => li.textContent),
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        // Add system-specific details
        switch(quote.systemType) {
            case 'healthcare':
                quote.details = {
                    plan: document.getElementById('healthcarePlan').value,
                    size: document.getElementById('healthcareSize').value
                };
                break;
            case 'event':
                quote.details = {
                    attendees: document.getElementById('eventAttendees').value,
                    duration: document.getElementById('eventDuration').value,
                    extraAttendees: parseInt(document.getElementById('extraAttendees').value) || 0
                };
                break;
            case 'supply':
                quote.details = {
                    components: ['tms', 'wms', 'ofm', 'portal', 'admin'].reduce((acc, component) => {
                        if (document.getElementById(`${component}Check`).checked) {
                            acc[component] = document.getElementById(`${component}Capacity`).value;
                        }
                        return acc;
                    }, {}),
                    additionalUsers: parseInt(document.getElementById('additionalUsers').value) || 0,
                    premiumSupport: document.getElementById('premiumSupport').checked
                };
                break;
        }

        // Save to Firestore and generate PDF
        db.collection('quotes').add(quote)
            .then((docRef) => {
                // Add the document ID as the quote serial
                const quoteSerial = docRef.id;
                db.collection('quotes').doc(docRef.id).update({
                    quoteSerial: quoteSerial
                }).then(() => {
                    quote.quoteSerial = quoteSerial;
                    generatePDF(quote);
                    document.getElementById("confirmationMessage").textContent = 
                        `🎉 Congratulations! Your quote (ID: ${quoteSerial}) has been saved. We will contact you via email soon.`;
                    document.getElementById("confirmationMessage").style.display = "block";
                });
            })
            .catch(error => {
                console.error('Error saving quote: ', error);
                alert('Error saving quote. Please try again.');
            });
    }

    function generatePDF(quote) {
        // Ensure jsPDF is properly loaded
        if (typeof window.jspdf === 'undefined') {
            console.error('jsPDF is not loaded');
            return;
        }

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Set initial y position
        let yPos = 20;

        // Helper function to add text and increment y position
        function addText(text, fontSize = 12, isBold = false) {
            doc.setFontSize(fontSize);
            doc.setFont("helvetica", isBold ? "bold" : "normal");
            doc.text(text, 20, yPos);
            yPos += fontSize/2 + 5;
        }

        // Header
        addText("SaaS Quote Summary", 20, true);
        yPos += 10; // Extra spacing after header

        // Quote details
        addText(`Quote Serial: ${quote.quoteSerial}`);
        addText(`Date: ${new Date().toLocaleDateString()}`);
        yPos += 5;

        // Customer information
        addText("Customer Information", 14, true);
        addText(`Name: ${quote.customerName}`);
        addText(`Email: ${quote.customerEmail}`);
        addText(`Phone: ${quote.customerPhone}`);
        yPos += 5;

        // System details
        addText("System Details", 14, true);
        addText(`Selected System: ${quote.system}`);
        addText(`Plan/Configuration: ${quote.plan}`);
        yPos += 5;

        // Cost breakdown
        addText("Cost Breakdown", 14, true);
        quote.breakdown.forEach(item => {
            addText(`• ${item}`);
        });
        yPos += 5;

        // Totals
        addText("Total Cost", 14, true);
        addText(`Monthly Total: R${quote.monthlyTotal.toLocaleString()}`);
        addText(`Annual Total: R${quote.annualTotal.toLocaleString()}`);

        // Save the PDF
        try {
            doc.save(`Quote_${quote.quoteSerial}.pdf`);
        } catch (error) {
            console.error('Error generating PDF:', error);
            alert('Error generating PDF. Please try again.');
        }
    }

        function toggleCapacity(component) {
            const checkbox = document.getElementById(component + 'Check');
            const select = document.getElementById(component + 'Capacity');
            select.disabled = !checkbox.checked;
            calculateTotal();
        }
 function updateContactInfo() {
            document.getElementById('displayCustomerName').textContent = document.getElementById('customerName').value || 'N/A';
            document.getElementById('displayCustomerEmail').textContent = document.getElementById('customerEmail').value || 'N/A';
            document.getElementById('displayCustomerPhone').textContent = document.getElementById('customerPhone').value || 'N/A';
            document.getElementById('displayCustomerNotes').textContent = document.getElementById('customerNotes').value || 'N/A';
        }
        function calculateTotal() {
            let monthlyTotal = 0;
            const systemType = document.getElementById('systemType').value;
            let breakdown = [];

            if (systemType === 'healthcare') {
                const plan = document.getElementById('healthcarePlan').value;
                const size = document.getElementById('healthcareSize').value;
                const pricing = {
                    base: { private: 2500, small: 5000, medium: 10000, large: 20000 },
                    standard: { private: 5000, small: 10000, medium: 20000, large: 30000 },
                    premium: { private: 10000, small: 20000, medium: 30000, large: 40000 },
                    enterprise: { private: 50000, small: 75000, medium: 100000, large: 150000 }
                };
                monthlyTotal = pricing[plan][size];
                breakdown.push(`${plan} Plan (${size}): R${monthlyTotal}`);
                document.getElementById('selectedPlan').textContent = `${plan} Plan (${size})`;
            }

            if (systemType === 'supply') {
                ['tms', 'wms', 'ofm', 'portal', 'admin'].forEach(component => {
                    if (document.getElementById(`${component}Check`).checked) {
                        const capacity = document.getElementById(`${component}Capacity`).value;
                        const pricing = {
                            tms: { small: 15000, medium: 25000, large: 45000 },
                            wms: { small: 18000, medium: 30000, large: 55000 },
                            ofm: { basic: 8000, standard: 15000, enterprise: 25000 },
                            portal: { basic: 5000, professional: 12000, enterprise: 20000 },
                            admin: { basic: 4000, professional: 8000, enterprise: 15000 }
                        };
                        let cost = pricing[component][capacity];
                        monthlyTotal += cost;
                        breakdown.push(`${component.toUpperCase()} (${capacity}): R${cost}`);
                    }
                });
                document.getElementById('selectedPlan').textContent = 'Selected Components';
            }

            document.getElementById('selectedSystem').textContent = systemType;
            document.getElementById('costBreakdown').innerHTML = breakdown.map(item => `<li>${item}</li>`).join('');
            document.getElementById('monthlyTotal').textContent = monthlyTotal.toLocaleString();
            document.getElementById('annualTotal').textContent = (monthlyTotal * 12).toLocaleString();
        }

        function calculateHealthcareTotal() {
            const plan = document.getElementById('healthcarePlan').value;
            const size = document.getElementById('healthcareSize').value;
            
            const pricing = {
                base: {
                    private: 2500,
                    small: 5000,
                    medium: 10000,
                    large: 20000
                },
                standard: {
                    private: 5000,
                    small: 10000,
                    medium: 20000,
                    large: 30000
                },
                premium: {
                    private: 10000,
                    small: 20000,
                    medium: 30000,
                    large: 40000
                },
                enterprise: {
                    private: 50000,
                    small: 75000,
                    medium: 100000,
                    large: 150000
                }
            };

            return pricing[plan][size];
        }

        function calculateEventTotal() {
            const attendees = document.getElementById('eventAttendees').value;
            const duration = document.getElementById('eventDuration').value;
            
            const pricing = {
                tier1: {
                    daily: 150,
                    weekly: 600,
                    monthly: 1500,
                    quarterly: 4000,
                    annually: 15000
                },
                tier2: {
                    daily: 270,
                    weekly: 1080,
                    monthly: 2700,
                    quarterly: 7200,
                    annually: 27000
                },
                tier3: {
                    daily: 550,
                    weekly: 2200,
                    monthly: 5500,
                    quarterly: 15000,
                    annually: 55000
                },
                tier4: {
                    daily: 1300,
                    weekly: 5200,
                    monthly: 13000,
                    quarterly: 35000,
                    annually: 130000
                },
                tier5: {
                    daily: 1500,
                    weekly: 6000,
                    monthly: 13000,
                    quarterly: 40500,
                    annually: 150000
                }
            };

            let total = pricing[attendees][duration];

            if (attendees === 'tier5') {
                const extraAttendees = document.getElementById('extraAttendees').value;
                const extraCost = Math.ceil(extraAttendees / 150) * 1000;
                total += extraCost;
            }

            return total;
        }

        function calculateSupplyChainTotal() {
            let total = 0;

            // TMS
            if (document.getElementById('tmsCheck').checked) {
                const tmsCapacity = document.getElementById('tmsCapacity').value;
                const tmsPricing = {
                    small: 15000,
                    medium: 25000,
                    large: 45000
                };
                total += tmsPricing[tmsCapacity];
            }

            // WMS
            if (document.getElementById('wmsCheck').checked) {
                const wmsCapacity = document.getElementById('wmsCapacity').value;
                const wmsPricing = {
                    small: 18000,
                    medium: 30000,
                    large: 55000
                };
                total += wmsPricing[wmsCapacity];
            }

            // Order Fulfillment
            if (document.getElementById('ofmCheck').checked) {
                const ofmCapacity = document.getElementById('ofmCapacity').value;
                const ofmPricing = {
                    basic: 8000,
                    standard: 15000,
                    enterprise: 25000
                };
                total += ofmPricing[ofmCapacity];
            }

            // Customer Portal
            if (document.getElementById('portalCheck').checked) {
                const portalCapacity = document.getElementById('portalCapacity').value;
                const portalPricing = {
                    basic: 5000,
                    professional: 12000,
                    enterprise: 20000
                };
                total += portalPricing[portalCapacity];
            }

            // Admin Dashboard
            if (document.getElementById('adminCheck').checked) {
                const adminCapacity = document.getElementById('adminCapacity').value;
                const adminPricing = {
                    basic: 4000,
                    professional: 8000,
                    enterprise: 15000
                };
                total += adminPricing[adminCapacity];
            }

            // Additional Users
            const additionalUsers = document.getElementById('additionalUsers').value;
            total += additionalUsers * 500;

            // Premium Support
            if (document.getElementById('premiumSupport').checked) {
                total += 5000;
            }

            return total;
        }

        function saveQuote() {
    if (!validateForm()) return;

    const quote = {
        systemType: document.getElementById('systemType').value,
        customerName: document.getElementById('customerName').value,
        customerEmail: document.getElementById('customerEmail').value,
        customerPhone: document.getElementById('customerPhone').value,
        customerNotes: document.getElementById('customerNotes').value,
        monthlyTotal: parseFloat(document.getElementById('monthlyTotal').textContent.replace(/,/g, '')),
        annualTotal: parseFloat(document.getElementById('annualTotal').textContent.replace(/,/g, '')),
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    };

    // Add system-specific details
    switch(quote.systemType) {
        case 'healthcare':
            quote.details = {
                plan: document.getElementById('healthcarePlan').value,
                size: document.getElementById('healthcareSize').value
            };
            break;
        case 'event':
            quote.details = {
                attendees: document.getElementById('eventAttendees').value,
                duration: document.getElementById('eventDuration').value,
                extraAttendees: parseInt(document.getElementById('extraAttendees').value) || 0
            };
            break;
        case 'supply':
            quote.details = {
                components: ['tms', 'wms', 'ofm', 'portal', 'admin'].reduce((acc, component) => {
                    if (document.getElementById(`${component}Check`).checked) {
                        acc[component] = document.getElementById(`${component}Capacity`).value;
                    }
                    return acc;
                }, {}),
                additionalUsers: parseInt(document.getElementById('additionalUsers').value) || 0,
                premiumSupport: document.getElementById('premiumSupport').checked
            };
            break;
    }

    // Save to Firestore
    db.collection('rentalQuotes').add(quote)
        .then((docRef) => {
            alert('Quote saved successfully! Reference ID: ' + docRef.id);
            // Optionally reset form here
        })
        .catch((error) => {
            console.error('Error saving quote: ', error);
            alert('Error saving quote. Please try again.');
        });
}
</script>
</body>
</html>